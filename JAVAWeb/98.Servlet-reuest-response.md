# 2. Servlet - ìš”ì²­Â·ì‘ë‹µ API / Form ì†ì„±

> `HttpServletRequest` / `HttpServletResponse` / `getParameter()` / `setContentType()`

<br>
<br>

- âœğŸ» **Recorded Date** : 2022ë…„ 12ì›” 8ì¼
- ğŸ”– **Notion** : [ë…¸ì…˜ì—ì„œ ë³´ê¸°](https://www.notion.so/6suk/2-Servlet-API-Form-b9801f1535fe41cd94ac59975d029585?pvs=4)

<br>
<br>

## ğŸ”¸ ì„œë¸”ë¦¿ ìš”ì²­ê³¼ ì‘ë‹µ API

- **ìš”ì²­ API** : javax.servlet.http.HttpServlet**Request** í´ë˜ìŠ¤
- **ì‘ë‹µAPI** : javax.servlet.http.HttpServlet**Response** í´ë˜ìŠ¤

```java
protected void doGet(HttpServletRequest request, HttpServletResponse response)
	throws ServletException, IOException {
		...
}

protected void doPost(HttpServletRequest request, HttpServletResponse response)
	throws ServletException, IOException {
		...
}
```

<br><br>

## ğŸ”¸ ìš”ì²­ API - HttpServletRequest ë©”ì„œë“œ

<img src="./img/javaweb_img_01.png"><br>

### â—½ QueryString ì´ë€?

- ì£¼ì†Œì°½ì— ì •ë³´ë¥¼ ìš”ì²­í•  ë•Œ(get) ë¬¼ìŒí‘œ ë’¤ì— ì˜¤ëŠ” ì¶”ê°€ ë°ì´í„°
- ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì€ ë§ ê·¸ëŒ€ë¡œ String ì´ê¸° ë•Œë¬¸ì— ê°’ì„ ë°›ì„ ë•Œ String íƒ€ì…ìœ¼ë¡œ ë°›ì•„ì¤˜ì•¼í•œë‹¤.
- ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì€ name, value í•œ ìŒìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤
  - `year` : name / `2021` : value

<br><br>

## ğŸ”¸ HTML - form íƒœê·¸ì˜ ì†ì„±

- HTMLì—ì„œ `<form>` íƒœê·¸ë¡œ ì„œë¸”ë¦¿ì— ìš”ì²­
- `submit` í´ë¦­ ì‹œ input íƒœê·¸ì˜ name **ì†ì„±ì˜ ê°’**ê³¼ **ì‹¤ì œ ì…ë ¥í•œ ë°ì´í„° ì „ì†¡**

```html
<form name="login" method="post" action="/ch06/login" enctype="UTF-8">
  <input type="text" name="uid" />
  <input type="text" name="pwd" />
  <input type="submit" name="uid" value="ë¡œê·¸ì¸" />
</form>
```

- `name`
  - íƒœê·¸ì˜ ì´ë¦„ ì§€ì •, ì—¬ëŸ¬ ê°œì˜ formì´ ì¡´ì¬í•  ê²½ìš° êµ¬ë¶„í•˜ëŠ” ì—­í• 
  - ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ form íƒœê·¸ì— ì ‘ê·¼í•  ë•Œ ìì£¼ ì‚¬ìš©
- `method`
  - ë°ì´í„° ì „ì†¡ ë°©ë²• ì§€ì • ( get / post ) , ì•„ë¬´ê²ƒë„ ì§€ì •í•˜ì§€ ì•Šì„ ê²½ìš° getì´ ê¸°ë³¸ê°’
- `action`
  - form íƒœê·¸ì—ì„œ ë°ì´í„°ë¥¼ ì „ì†¡í•  ì„œë¸”ë¦¿ì´ë‚˜ JSP ì§€ì •
  - ì„œë¸”ë¦¿ ì „ì†¡ : ë§¤í•‘ ì´ë¦„ ì‚¬ìš©
- `encType`
  - ì „ì†¡í•  ë°ì´í„°ì˜ encodingíƒ€ì… ì§€ì •
  - íŒŒì¼ ì—…ë¡œë“œ : multipart/form-dataë¡œ ì§€ì •

<br><br>

## ğŸ”¸ ìš”ì²­ API - HttpServletRequest ë©”ì„œë“œ

- ì „ì†¡ëœ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” ë©”ì„œë“œ

| íƒ€ì…     | ë©”ì†Œë“œëª…                        | ë‚´ìš©                                                                                                                                                   |
| -------- | ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| String   | getParameter(String name)       | Clientê°€ ë³´ë‚´ì¤€ ê°’ì´ ë§¤ê°œë³€ìˆ˜ê³¼ ê°™ì€ ëª…ì¹­ì— ì €ì¥ëœ ê°’ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë©”ì†Œë“œ                                                                                |
|          | getParameterNames()             | Clientê°€ ë³´ë‚´ì¤€ ê°’ì„ ì €ì¥í•œ ëª…ì¹­(Key)ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë©”ì†Œë“œ<br>name ê°’ì„ ëª¨ë¥¼ ë•Œ ì‚¬ìš©                                                                      |
| String[] | getParameterValues(String name) | Clientê°€ ë³´ë‚´ì¤€ ê°’ì´ ì—¬ëŸ¬ê°œì¼ ê²½ìš° ê·¸ ê°’ì„ ë°°ì—´ë¡œ ë¶ˆëŸ¬ì˜¤ëŠ” ë©”ì†Œë“œ(Key ì œì™¸)                                                                            |
| Map      | getParameterMap()               | Clientê°€ ë³´ë‚´ì¤€ ê°’ì˜ ì „ì²´ë¥¼ Map ë°©ì‹ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ëŠ” ë©”ì†Œë“œ                                                                                               |
| Object   | setAttribute(String,object)     | requestê°ì²´ì— ì „ë‹¬í•˜ê³  ì‹¶ì€ ê°’ì„ Strting ì´ë¦„ìœ¼ë¡œ Object íƒ€ì…ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ë©”ì†Œë“œ<br>ex) req.setAttiribute(â€ê°ì²´ëª…â€, ê°ì²´) â†’ Keyì™€ Value í˜•ì‹ìœ¼ë¡œ ì „ë‹¬ |
| Object   | getAttribute(String)            | ë§¤ê°œë³€ìˆ˜ì™€ ë™ì¼í•œ ê°ì²´ ì†ì„±ê°’ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë©”ì†Œë“œ                                                                                                        |
|          | removeAttibute(String)          | request ê°ì²´ì— ì €ì¥ë˜ì–´ ë§¤ê°œë³€ìˆ˜ì™€ ë™ì¼í•œ ì†ì„±ê°’ì„ ì‚­ì œí•˜ëŠ” ë©”ì†Œë“œ                                                                                     |
|          | setCharacterEncoding(String)    | ì „ì†¡ë°›ì€ requesê°ì²´ì˜ ê°’ë“¤ì˜ CharaterSetì„ ì„¤ì •í•´ì£¼ëŠ” ë©”ì†Œë“œ<br>ex) request.setCharacterEncoding("UTF-8");                                             |
|          | getRequestDispatcher(String)    | ì»¨ë°ì´ë„ˆë‚´ì—ì„œ request, responseê°ì²´ë¥¼ ì „ì†¡í•˜ì—¬ ì²˜ë¦¬í•  ì»¨í¬ë„ŒíŠ¸(jsp íŒŒì¼ ë“±)ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë©”ì†Œë“œë¡œ forward()ë©”ì†Œë“œì™€ ê°™ì´ ì‚¬ìš©                           |

<br>

### â—½ ìš”ì²­API - ì˜ˆì‹œì½”ë“œ

```html
<form action="/ch06/register" method="post">
  <input type="text" name="uid" placeholder="ID" maxlength="10" minlength="1" required />
  <input type="password" name="pwd" placeholder="Password" required />
  <input type="checkbox" name="hobby" value="ë†€ê¸°" />ë†€ê¸° <input type="checkbox" name="hobby" value="ì½”ë”©" />ì½”ë”©
  <input type="submit" value="íšŒì›ê°€ì…" />
</form>
```

```java
request.setCharacterEncoding("utf-8");
String uid = request.getParameter("uid");
String pwd = request.getParameter("pwd");
String[] hobby = request.getParameterValues("hobby");
```

<br><br>

## ğŸ”¸ ì‘ë‹µì²˜ë¦¬ - HttpServletResponse

- `doGet()`ì´ë‚˜ `doPost()` ë©”ì„œë“œ ì•ˆì—ì„œ ì²˜ë¦¬
- javax.servlet.http.HttpServletResponse ê°ì²´ ì´ìš©
- `setContentType()` ì„ ì´ìš©í•´ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡í•  ë°ì´í„° ì¢…ë¥˜(MIME-TYPE)ë¥¼ ì§€ì •í•¨
- í´ë¼ì´ì–¸íŠ¸(ì›¹ ë¸Œë¼ìš°ì €)ì™€ ì„œë¸”ë¦¿ì˜ í†µì‹ ì€ ìë°” I/Oì˜ ìŠ¤íŠ¸ë¦¼ ì´ìš©

<br>

### â—½ MINE-TYPE

- í†°ìº£ ì»¨í…Œì´ë„ˆì— ë¯¸ë¦¬ ì§€ì •í•´ ë†“ì€ ë°ì´í„° ì¢…ë¥˜
- ì„œë¸”ë¦¿ì—ì„œ ë¸Œë¼ìš°ì €ë¡œ ì „ì†¡ ì‹œ ì„¤ì •í•´ì„œ ì‚¬ìš©
- **HTML** : text/html
- **ì¼ë°˜ í…ìŠ¤íŠ¸** : text/plain
- **XML ë°ì´í„°** : application/xm
- ë” ë‹¤ì–‘í•œ íƒ€ì…ì€ `Tomcat` â†’ `web.xml` â†’ `<extension>` ì—ì„œ í™•ì¸ ê°€ëŠ¥

<br>

### â—½ ì‘ë‹µ ì²˜ë¦¬ ìˆœì„œ

1. `setContentType()` ì´ìš©, MIME-TYPE ì§€ì •
2. ë°ì´í„° ì¶œë ¥í•  `PrintWriter` ê°ì²´ ìƒì„±
3. ì¶œë ¥ ë°ì´í„°ë¥¼ HTML í˜•ì‹ìœ¼ë¡œ ì œì‘
4. `PrintWriter`ì˜ `print()` `println()`ì„ ì´ìš©í•´ ë°ì´í„° ì¶œë ¥

<br>

### â—½ ì˜ˆì‹œì½”ë“œ

```java
response.setContentType("text/html; charset=UTF-8"); // 1ë²ˆ
PrintWriter out = response.getWriter(); // 2ë²ˆ
out.print(...); // 4ë²ˆ
```

<br><br><br><br>
